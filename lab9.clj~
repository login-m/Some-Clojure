

(def euler-helper
  (fn [x term count]
     (list term
           (fn [] (euler x (* term (/ x count)) (+ count 1))))))


(def euler
  (fn [x]
    (euler-hepler x 1.0 1.0)))


(def nt
  (fn [terms]
    (first terms)))

(def rt
  (fn [terms]
    ((first (rest terms)))))


(def sum-helper
  (fn [e epsilon sum]
    (if (< (nt e) epsilon)
      (+ 1 sum)
    (recur (rt e) epsilon (+ sum (nt e))))))

(def sum
  (fn [e epsilon]
    (sum-helper e epsilon 0.0)))
      
